---
title: "Milk Prices"
author: "Richard Marks"
date: "2/13/2020"
output: pdf_document
---

```{r setup, include=FALSE}
library(mosaic)
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)
```
To answer the question of what price a store should sell its milk at we must use a decpetivly simple looking formula. n=(p-c)Q, where n is the price the milk should be sold, p is the price the milk is already sold, c is the cost of the milk for the store, and Q is the quantity of milk sold. However Q is actually a function of P, since the price of the milk effects how much milk is actually sold. So the function is actually n=(p-c)*f(p), where c=1
```{r}
load("~/.Rdata")
plot(sales ~ price, data = milkquestion)
plot(log(sales)~log(price), data=milkquestion)
lm_ped= lm(log(sales)~ log(price), data = milkquestion)
coef(lm_ped)
```
Now if we plot the price of the milk and the quantity sold we see that the relationship is nonlinear. However if we take the logarithim of both the price and quantity and plot it on a graph we find a negative linear relationship between the two. Since we have created a linear relationship we can now use linear regression to find the slope and intercept. Since quantity is a function of price it can be expressed as Q= e^alpha*p^beta where alpha= exp(intercept) and beta= slope.
```{r}
alpha=exp(coef(lm_ped)[1])
beta= coef(lm_ped)[2]
curve((x-1)*alpha*(x^beta))
curve((x-1)*alpha*(x^beta), from = 2.5, 2.7)
```
Now that we know what q is we have everything we need to find the optimal price of milk. if we plug in q the equation is n=(p-1)*alpha*p^beta. If we plot this equation onto a graph we can see that there is a peak maximum between $2.60 and $2.65. Therefore that is the optimal price range for milk. 

