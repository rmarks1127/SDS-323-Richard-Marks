---
title: "Green Buildings"
author: "Richard Marks"
date: "2/12/2020"
output: pdf_document
---

```{r setup, include=FALSE}
library(mosaic)
library(tidyverse)
library(ggplot2)
knitr::opts_chunk$set(echo = FALSE)
```
Given the "data guru's" arguement the company would be making significantly more money if it were to go green. However there are several flaws in the way they interperated the data. The first flaw is they looked at the median of the rent prices instead of the mean. While there are a few outliers they do not significantly effect the data. The mean is still the better way to determine the average rent price. The other major flaw is that they did not use any nuance in their approach to this problem. They took two rent medians, buildings that are green and those who are not. In reality the rent could be affected by a whole host of other issues. The one I have chosen to focus on is building class. 

Buildings come in three seperate classes, the best are A class, the okay are B class, and the worst are C class. Since our building is being built on East Cesar Chavez it is safe to assume that it will either be a class A or B building. To get a better understanding of the data I combined the A & B class buildings into one group and got the mean rent for both those that are and are not green buildings. I also compiled the average rents for c class buildings both green and not.



```{r}
load("~/.Rdata")
green_class_rent= (greenbuildings %>% group_by(green_rating, class_a, class_b )) %>% summarise(rent= mean(Rent, na.rm= TRUE))
class_rent= green_class_rent %>% group_by(green_rating, rent) %>% summarise(sum(class_a + class_b, na.rm = TRUE))
classy_rent= class_rent %>% rename(ClassAB=`sum(class_a + class_b, na.rm = TRUE)`)
classy= classy_rent %>% group_by(ClassAB, green_rating) %>% summarise(mean(rent, na.rm= TRUE))
rent_by_class=classy%>% rename(Rent=`mean(rent, na.rm = TRUE)`)
```
```{r}
labels <- c("0" = "Class C", "1" = "Class A&B")
```

```{r}
ggplot(data= rent_by_class) + geom_bar(mapping= aes(x= green_rating, y=Rent), stat='identity') + facet_wrap(~ClassAB, nrow = 2, ncol = 3, labeller=labeller(ClassAB = labels)) + labs(title = "A Comparison of Average Rent Between Building Class and Green Rating", x= "Green Rating", y="Average Rent (per square foot)", caption = "A plot comparing average rent prices between buildings of different classes and green ratings. 
On the X axis the bar centered at zero is for buildings that are not either LEED or EnergyStar certified.
The bar centered at one stands for buildings that are LEED or EnergyStar certified. ")
```

The data above shows that being green only increases the average rent of class C buildings, in fact average rent for green class A&B buildings (mean=$28.54) is actually less than that of non green class A&B buildings (mean=$29.50) by .96 cents. So by going green the company will be losing 250,000 * $.96= $240.000. Therefore making a green building would not be a good financial move for the company


